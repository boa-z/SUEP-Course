# 7 有限脉冲响应数字滤波器的设计

## 7.1 线性相位FIR数字滤波器的条件和特点

### 7.1.1 线性相位FIR数字滤波器

对于长度为N的h(n)，频率响应函数为

$$
H(e^{j\omega}) = \sum_{n=0}^{N-1} h(n) e^{-j\omega n} \\
H(e^{j\omega}) = H_g (\omega) e^{-j \theta(\omega)}
$$

---

线性相位FIR滤波器是指 $\theta(\omega)$ 是 $\omega$ 的线性函数，即

$$
\theta(\omega) = - \tau \omega
$$

如果 $\theta(\omega)$ 满足下式：

$$
\theta(\omega) = \theta_0 - \tau \omega
$$

$\theta_0$ 称为初始相位，$\tau$ 称为群延迟。

* 第一类线性相位
* 第二类线性相位

### 7.1.2 线性相位FIR的时域约束条件

线性相位FIR滤波器的时域约束条件是指满足线性相位时，对 h(n) 的约束条件。

#### 7.1.2.1 第一类线性相位对h(n)的约束条件

所以要求 $\tau$ 和 $h(n)$ 满足如下条件:

$$
\begin{cases}
    \theta(\omega) = - \omega \tau & \tau = \frac{N-1}{2} \\
    h(n) = h(N-n-1) & 0 \leq n \leq N - 1
\end{cases}
$$

#### 7.1.2.2 第二类线性相位对h(n)的约束条件

所以要求 $\tau$ 和 $h(n)$ 满足如下条件:

$$
\begin{cases}
    \theta(\omega) = -\frac{\pi}{2} - \omega \tau & \tau = \frac{N-1}{2} \\
    h(n) = -h(N-n-1) & 0 \leq n \leq N - 1
\end{cases}
$$

### 7.1.3 线性相位FIR滤波器幅度特性Hg(ω)的特点

时域约束条件 $h(n)= \pm h(N－n－1)$

幅度特性 $H_g(\omega)$ 的特点就是线性相位FIR滤波器的频域约束条件。

当N取奇数和偶数时对 $H_g(\omega)$ 的约束不同，因此，对于两类线性相位特性，下面分四种情况讨论其幅度特性的特点。
为了推导方便，引入两个参数符号：

$$
\tau = \frac{N - 1}{2}, M = \lfloor \frac{N-1}{2} \rfloor
$$

半中括号表示向下取整（PDF上的错了）
仅当N为奇数时，$M = \tau = (N－1)/2$

#### 7.1.3.1 情况1

当N为奇数时，$M = \tau = (N－1)/2$

#### 7.1.3.2 情况2

#### 7.1.3.3 情况3

[2023-12-26]

#### 7.1.3.4 情况4

---

#### 总结

| $h(n)$           | 第一类                          | 第二类                                        |
| ---------------- | ------------------------------- | --------------------------------------------- |
| h(n)             | h(n) = h(N-1-n)                 | h(n) = -h(N-1-n)                              |
| $\theta(\omega)$ | $\theta(\omega) = -\omega \tau$ | $\theta(\omega)=-\frac{\pi}{2} - \omega \tau$ |

第一类

第二类

=> HEIC*2

### 7.1.4 线性相位FIR数字滤波器的零点分布特点

可以看出，如 $z=z_i$ 是 $H(z)$ 的零点，其倒数 $z_i^{−1}$ 也必然是其零点； 又因为 $h(n)$ 是实序列，$H(z)$ 的零点必定共轭成对，因此 $z_i^*$ 和 $(z_i^{−1})^*$ 也是其零点。这样，线性相位FIR滤波器零点必定是互为倒数的共轭对，确定其中一个，另外三个零点也就确定了。

关联共轭道义关系、全通滤波器。

## 7.2 利用窗函数法设计FIR滤波器

### 7.2.1 窗函数法设计原理

PDF
